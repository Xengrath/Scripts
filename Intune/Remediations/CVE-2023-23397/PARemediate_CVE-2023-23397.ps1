<#
.SYNOPSIS
	This script is used to remediate if Microsoft 365 Apps for Enterprise is running latest Security Updates
.DESCRIPTION
    This script is used to detect if Microsoft 365 Apps for Enterprise is running latest Security Updates,
    It is intended to be run as a Proactive Remediation from Microsoft Intune
.NOTES
	Author:         Timothy Ransom
    Version:        1.0.0.0
    Version Date:   19-MAR-2023

    1.0.0.0 - (19-MAR-2023) - Script Created

    This script is a modified version of the following script:
    https://gist.github.com/nicolonsky/b04dd77129577f782178c0c049344101
#>

##*===============================================
##* REMEDIATION
##*===============================================

# Attempt to launch the Microsoft 365 Apps for Enterprise update process
Try {
    Start-Process -FilePath "C:\Program Files\Common Files\microsoft shared\ClickToRun\OfficeC2RClient.exe" -ArgumentList "/update user" -Wait
    # If the update process completes successfully, remove the "updatetargetversion" registry value
    Remove-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\office\16.0\common\officeupdate" -Name "updatetargetversion" -Force
}
# If the update process fails, display an error message
catch {
    $errMsg = $_.Exception.Message
    Write-Host "Unable to launch update"
    Write-Host $errMsg
}